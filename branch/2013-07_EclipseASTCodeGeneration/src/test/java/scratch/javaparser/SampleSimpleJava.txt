package scratch.javaparser;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.List;

import org.eclipse.jdt.core.dom.AST;
import org.eclipse.jdt.core.dom.ASTParser;
import org.eclipse.jdt.core.dom.CompilationUnit;
import org.eclipse.jdt.core.dom.ImportDeclaration;

public class TryEclipseJDT {
	public static void main(String[] args) {
		System.out.println("Hello world");
		
		ASTParser parser = ASTParser.newParser(AST.JLS4);
		parser.setSource(getSource().toCharArray());
		CompilationUnit unit = (CompilationUnit)parser.createAST(null);
		unit.recordModifications();
		
	    // to get the imports from the file
	    List<ImportDeclaration> imports = unit.imports();
	    for (ImportDeclaration i : imports) {
	        System.out.println(i.getName().getFullyQualifiedName());
	    }		
	}
	
	private static String getSource() {
		BufferedReader reader = null;
		try {
			StringBuilder buf = new StringBuilder();
			InputStream is = TryEclipseJDT.class.getResourceAsStream("SampleSimpleJava.txt");
			reader = new BufferedReader(new InputStreamReader(is));
			String line;
			while ((line = reader.readLine()) != null) {
				buf.append(line).append("\n");
			}
			return buf.toString();
		} catch (IOException e) {
			throw new RuntimeException(e);
		} finally {
			try {
				reader.close();
			} catch (IOException dropped) {} // assume caused by earlier exception
		}
	}
}
